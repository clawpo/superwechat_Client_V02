package cn.ucai.superwechat.data;

import android.app.Activity;


public class MultipartActivity extends Activity {
//
//    private final Context context = this;
//    private final String twoHyphens = "--";
//    private final String lineEnd = "\r\n";
//    private final String boundary = "apiclient-" + System.currentTimeMillis();
//    private final String mimeType = "multipart/form-data;boundary=" + boundary;
//    private byte[] multipartBody;
//
//    @Override
//    protected void onCreate(Bundle savedInstanceState) {
//        super.onCreate(savedInstanceState);
//        setContentView(R.layout.activity_multipart);
//
//        byte[] fileData1 = getFileDataFromDrawable(context, R.drawable.ic_action_android);
//        byte[] fileData2 = getFileDataFromDrawable(context, R.drawable.ic_action_book);
//
//        ByteArrayOutputStream bos = new ByteArrayOutputStream();
//        DataOutputStream dos = new DataOutputStream(bos);
//        try {
//            // the first file
//            buildPart(dos, fileData1, "ic_action_android.png");
//            // the second file
//            buildPart(dos, fileData2, "ic_action_book.png");
//            // send multipart form data necesssary after file data
//            dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);
//            // pass to multipart body
//            multipartBody = bos.toByteArray();
//        } catch (IOException e) {
//            e.printStackTrace();
//        }
//
//        String url = "http://192.168.1.100/api/postfile";
//        MultipartRequest multipartRequest = new MultipartRequest(url, null, mimeType, multipartBody, new Response.Listener<NetworkResponse>() {
//            @Override
//            public void onResponse(NetworkResponse response) {
//                Toast.makeText(context, "Upload successfully!", Toast.LENGTH_SHORT).show();
//            }
//        }, new Response.ErrorListener() {
//            @Override
//            public void onErrorResponse(VolleyError error) {
//                Toast.makeText(context, "Upload failed!\r\n" + error.toString(), Toast.LENGTH_SHORT).show();
//            }
//        });
//
//        VolleySingleton.getInstance(context).addToRequestQueue(multipartRequest);
//    }
//
//    @Override
//    public boolean onCreateOptionsMenu(Menu menu) {
//        // Inflate the menu; this adds items to the action bar if it is present.
//        getMenuInflater().inflate(R.menu.menu_multipart, menu);
//        return true;
//    }
//
//    @Override
//    public boolean onOptionsItemSelected(MenuItem item) {
//        // Handle action bar item clicks here. The action bar will
//        // automatically handle clicks on the Home/Up button, so long
//        // as you specify a parent activity in AndroidManifest.xml.
//        int id = item.getItemId();
//
//        //noinspection SimplifiableIfStatement
//        if (id == R.id.action_settings) {
//            return true;
//        }
//
//        return super.onOptionsItemSelected(item);
//    }
//
//    private void buildPart(DataOutputStream dataOutputStream, byte[] fileData, String fileName) throws IOException {
//        dataOutputStream.writeBytes(twoHyphens + boundary + lineEnd);
//        dataOutputStream.writeBytes("Content-Disposition: form-data; name=\"uploaded_file\"; filename=\""
//                + fileName + "\"" + lineEnd);
//        dataOutputStream.writeBytes(lineEnd);
//
//        ByteArrayInputStream fileInputStream = new ByteArrayInputStream(fileData);
//        int bytesAvailable = fileInputStream.available();
//
//        int maxBufferSize = 1024 * 1024;
//        int bufferSize = Math.min(bytesAvailable, maxBufferSize);
//        byte[] buffer = new byte[bufferSize];
//
//        // read file and write it into form...
//        int bytesRead = fileInputStream.read(buffer, 0, bufferSize);
//
//        while (bytesRead > 0) {
//            dataOutputStream.write(buffer, 0, bufferSize);
//            bytesAvailable = fileInputStream.available();
//            bufferSize = Math.min(bytesAvailable, maxBufferSize);
//            bytesRead = fileInputStream.read(buffer, 0, bufferSize);
//        }
//
//        dataOutputStream.writeBytes(lineEnd);
//    }
//
//    private byte[] getFileDataFromDrawable(Context context, int id) {
//        Drawable drawable = ContextCompat.getDrawable(context, id);
//        Bitmap bitmap = ((BitmapDrawable) drawable).getBitmap();
//        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
//        bitmap.compress(Bitmap.CompressFormat.PNG, 0, byteArrayOutputStream);
//        return byteArrayOutputStream.toByteArray();
//    }
}
